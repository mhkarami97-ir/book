---
layout: post
full-width: true
title: Working Effectively with Legacy Code
subtitle: Working Effectively with Legacy Code
cover-img: /assets/images/working_effectively_with_legacy_code.jpg
thumbnail-img: /assets/images/working_effectively_with_legacy_code.jpg
share-img: /assets/images/working_effectively_with_legacy_code.jpg
tags: [ฺฉุชุงุจ, ูููุฏุณ, ุจุฑูุงูู_ููุณ]    
---

## ุชูุถุญุงุช
ุฏุฑ ุตูุนุชุ ุงุบูุจ ุงุฒ Legacy Code ุจู ุนููุงู ุงุตุทูุงุญ ุจุฑุง ฺฉุฏ ฺฉู ุชุบุฑุด ุณุฎุช ุงุณุช ู ูุง ุขู ุฑุง ููโูููู ุงุณุชูุงุฏู ูโุดูุฏ. ุงูุง ูู ูพุณ ุงุฒ ุณุงูโูุง ฺฉุงุฑ ุจุง ุชูโูุง ูุฎุชูู ู ฺฉูฺฉ ฺฉุฑุฏู ุจู ุขูโูุง ุฏุฑ ุฑูุน ฺฉุฑุฏู ูุดฺฉูุงุช ุฌุฏ ฺฉุฏ ูุงุดุงูุ ุจู ุชุนุฑู ูุชูุงูุช ุฏุณุช ุงูุชู.

ุงุฒ ูุธุฑ ูู Legacy Codeุ ฺฉุฏ ุงุณุช ฺฉู ูุงูุฏ ุชุณุช ุงุณุช. ฺูุฏ ุฏูู ูุฒ ุจุฑุง ุงู ุชุนุฑู ุฎูุฏู ุฏุงุฑู. ุชุณุชโูุง ฺู ุฑุจุท ุจู ุจุฏ ุจูุฏู ฺฉุฏ ุฏุงุฑูุฏุ ุงุฒ ูุธุฑ ูู ูพุงุณุฎ ุจุฏู ุงุณุช ู ุงู ูฺฉุชู ุง ุงุณุช ฺฉู ุฏุฑ ุงู ฺฉุชุงุจ ูโุฎูุงูู ุขู ุฑุง ุจุงู ฺฉูู:

ฺฉุฏ ุจุฏูู ุชุณุชุ ฺฉุฏ ุจุฏ ุงุณุช. ุงููุช ูุฏุงุฑุฏ ฺฉู ฺูุฏุฑ ุฎูุจ ููุดุชู ุดุฏู ุจุงุดุฏ ุง ฺูุฏุฑ ุฒุจุง ู ุด ฺฏุฑุง ุง ุจู ุฎูุจ ฺฉูพุณููู ุณุงุฒ ุดุฏู ุจุงุดุฏ. ุจุง ุฏุงุดุชู ุชุณุชโูุง ุงุณุช ฺฉู ูุง ูโุชูุงูู ุฑูุชุงุฑ ฺฉุฏ ุฑุง ุจู ุณุฑุนุช ู ุจู ุทุฑุฒ ุตุญุญ ุชุบุฑ ุฏูู. ุจุฏูู ุขูโูุง ูุง ูุงูุนุง ููโุฏุงูู ฺฉู ุขุง ฺฉุฏ ุจูุชุฑ ุดุฏู ุง ุจุฏุชุฑ ุดุฏู ุงุณุช.

## ูุธุฑ


## ูุธุฑ
 - `ุงูุชุงุฒ` : 00/10
 - `ุจู ุฏฺฏุฑุงู ุชูุตู ูโฺฉูู` : 
 - `ุฏูุจุงุฑู ูโุฎูุงูู` : 
 - `ุงุฏู ุจุฑุฌุณุชู` : 
 - `ุชุงุซุฑ ุฏุฑ ูู` : 
 - `ูฺฉุงุช ูุซุจุช` : 
 - `ูฺฉุงุช ููู` : 

## ูุดุฎุตุงุช
 - `ููุณูุฏู` : Michael C. Feathers
 - `ุงูุชุดุงุฑุงุช` : Prentice Hall
 - `ุตูุญู ูุดุฎุตุงุช` : [goodreads](https://www.goodreads.com/book/show/44919.Working_Effectively_with_Legacy_Code)  

## ุจุฎุดโูุง ุงุฒ ฺฉุชุงุจ

ุจุณุงุฑ ุฎูุจุ ุงฺฉููู ูุญุชูุง ุงุจุชุฏุง ฺฉุชุงุจ ุฑุง ุฏุฑุงูุช ฺฉุฑุฏู. ุงุฌุงุฒู ุฏูุฏ ุงููู ุจุฎุด ุฑุง ุจู ุตูุฑุช ููููู ู ุณุงุฎุชุงุฑุงูุชู ุจุฑุง ุดูุง ุชุดุฑุญ ฺฉูู.

## **Part I: The Mechanics of Change (ูฺฉุงูฺฉ ุชุบุฑ)**

### **ูุตู ฑ: Changing Software (ุชุบุฑ ูุฑูโุงูุฒุงุฑ)**

#### **ุจุฎุด ุงูู: ฺูุงุฑ ุฏูู ุจุฑุง ุชุบุฑ ูุฑูโุงูุฒุงุฑ**

ูุงฺฉู ููุชุฑุฒ ุฏุฑ ุงุจุชุฏุง ุงู ูุตู ฺฉ ุชูุงุฒ ุจูุงุฏู ุฑุง ูุทุฑุญ ูโฺฉูุฏ: ุชุบุฑ ฺฉุฏ ฺฉุงุฑ ูุงุณุชุ ุงูุง **ฺฺฏููฺฏ** ุงู ุชุบุฑ ูโุชูุงูุฏ ุฒูุฏฺฏ ูุง ุฑุง ุณุฎุช ุง ุขุณุงู ฺฉูุฏ. ุงู ฺูุงุฑ ุฏูู ุงุตู ุจุฑุง ุชุบุฑ ูุฑูโุงูุฒุงุฑ ุฑุง ูุทุฑุญ ูโฺฉูุฏ:

1. **ุงุถุงูู ฺฉุฑุฏู ฺฉ ูุงุจูุช (Adding a feature)**
2. **ุฑูุน ุจุงฺฏ (Fixing a bug)**
3. **ุจูุจูุฏ ุทุฑุงุญ (Improving the design)**
4. **ุจูููโุณุงุฒ ุงุณุชูุงุฏู ุงุฒ ููุงุจุน (Optimizing resource usage)**

#### **ูฺฉุชู ฺฉูุฏ ฑ: ุชูุงุฒ ุจู Add Feature ู Fix Bug ฺุงูุดโุจุฑุงูฺฏุฒ ุงุณุช**

ููุชุฑุฒ ูุซุงู ูโุฒูุฏ: ูุฏุฑ ูโฺฏูุฏ ููฺฏู ุตูุญู ุฑุง ุงุฒ ฺูพ ุจู ุฑุงุณุช ุจุจุฑุฏ ู animated ฺฉูุฏ. ุงู ฺฉ **bug** ุงุณุช ุง **feature**ุ

- ุงุฒ ูฺฏุงู **ูุดุชุฑ**: ฺฉ ูุดฺฉู ุงุณุช ฺฉู ุจุงุฏ ุจุฑุทุฑู ุดูุฏ.
- ุงุฒ ูฺฏุงู **ุชูุณุนูโุฏููุฏู**: ุงู ฺฉ feature ฺฉุงููุงู ุฌุฏุฏ ุงุณุช.

**ุงูุง ูุงูุนุช ฺุณุชุ**  
ุชูุงู ุงู ุจุญุซโูุง ูพุฑุฏูโุง ุงุณุช ฺฉู ฺฉ ููููู ูู ูููโุชุฑ ุฑุง ูพููุงู ูโฺฉูุฏ: **Behavioral Change** (ุชุบุฑ ุฑูุชุงุฑ).

> **ูุงุนุฏู ุทูุง:**  
> ุฑูุชุงุฑ (Behavior) ูููโุชุฑู ฺุฒ ุฏุฑ ูุฑูโุงูุฒุงุฑ ุงุณุช. ฺฉุงุฑุจุฑุงู ุจู ุขู ูุงุจุณุชูโุงูุฏ. ุงฺฏุฑ ุฑูุชุงุฑ ฺฉู ุจู ุขู ุงุนุชูุงุฏ ุฏุงุฑูุฏ ุฑุง ุชุบุฑ ุฏูู (ุง ุจุงฺฏ ุงุฌุงุฏ ฺฉูู)ุ ุงุนุชูุงุฏุดุงู ุฑุง ุงุฒ ุฏุณุช ูโุฏูู.

#### **ูฺฉุชู ฺฉูุฏ ฒ: ุชูุงุฒ ุจู "ุงูุฒูุฏู ุฑูุชุงุฑ" ู "ุชุบุฑ ุฑูุชุงุฑ"**

ููุชุฑุฒ ฺฉ ุชูุงุฒ ูู ููู ุงุฌุงุฏ ูโฺฉูุฏ:

- **ุงฺฏุฑ ุจุงุฏ ฺฉุฏ ุฑุง ุชุบุฑ ุฏูู** (modify existing code) โ ุงุญุชูุงูุงู ุฑูุชุงุฑ ุฑุง ุชุบุฑ ูโุฏูู.
- **ุงฺฏุฑ ููุท ฺฉุฏ ุฌุฏุฏ ุงุถุงูู ฺฉูู ู ุขู ุฑุง ูุฑุงุฎูุงู ฺฉูู** โ ูุนูููุงู ุฑูุชุงุฑ ุฌุฏุฏ ุงุถุงูู ูโฺฉูู.

**ูุซุงู Java:**

```java
public class CDPlayer {
    public void addTrackListing(Track track) { ... }
}
```

ุงฺฏุฑ ูุชุฏ ุฌุฏุฏ ุงุถุงูู ฺฉูู:

```java
public void replaceTrackListing(String name, Track track) { ... }
```

**ุขุง ุฑูุชุงุฑ ุชุบุฑ ฺฉุฑุฏุ** ุฎุฑ! ฺุฑุงุ ฺูู ูุชุฏ ูุฑุงุฎูุงู ูุดุฏู ุงุณุช.

ุงูุง ุงฺฏุฑ ฺฉ ุฏฺฉูู ุฏุฑ UI ุงุถุงูู ฺฉูู ฺฉู ุงู ูุชุฏ ุฑุง ูุฑุงุฎูุงู ูโฺฉูุฏ โ ุฑูุชุงุฑ ุงุถุงูู ูโุดูุฏ **ู** ุฑูุชุงุฑ ููุฌูุฏ (ุฑูุฏุฑ UI) ฺฉู ุชุบุฑ ูโฺฉูุฏ (ฺฉ ุฏฺฉูู ุจุดุชุฑุ ุฒูุงู ุฑูุฏุฑ ฺฉู ุจุงูุงุชุฑ).

> **ุจูุด ุนูู:**  
> ุชูุฑุจุงู ุบุฑููฺฉู ุงุณุช ฺฉู ุจุฏูู ุชุบุฑ ุญุฏุงูู ุฑูุชุงุฑุ ุฑูุชุงุฑ ุฌุฏุฏ ุงุถุงูู ฺฉูู.

---

## **ุจุฎุด ุฏูู: ุจูุจูุฏ ุทุฑุงุญ (Improving Design) ู ุจูููโุณุงุฒ (Optimization)**

### **ณ. ุจูุจูุฏ ุทุฑุงุญ (Design Improvement)**

ููุชุฑุฒ ุงูุฌุง ฺฉ ูฺฉุชู ุจุณุงุฑ ุงุณุงุณ ุฑุง ูุทุฑุญ ูโฺฉูุฏ: **ุชุบุฑ ุทุฑุงุญ ฺฉ ฺฉุงุฑ ูุชูุงูุช ุงุณุช**.

ููุช ูโุฎูุงูู ุณุงุฎุชุงุฑ ูุฑูโุงูุฒุงุฑ ุฑุง ุชุบุฑ ุฏูู ุชุง **ูุงุจูโูฺฏูุฏุงุฑโุชุฑ** ุดูุฏุ ูุนูููุงู ูโุฎูุงูู **ุฑูุชุงุฑ ูุฑูโุงูุฒุงุฑ ุจุฏูู ุชุบุฑ ุจุงู ุจูุงูุฏ**.

> **ูุดฺฉู ุงุณุงุณ:**  
> ุจุณุงุฑ ุงุฒ ุจุฑูุงููโููุณุงู ุชูุงุด ุจุฑุง ุจูุจูุฏ ุทุฑุงุญ ุฑุง ุงูุฌุงู ููโุฏููุฏุ ฺูู **ุจุณุงุฑ ุขุณุงู ุงุณุช ฺฉู ุฑูุชุงุฑ ุฑุง ุชุบุฑ ุฏููุฏ** ุง ุจุฏุชุฑุ **ุจุงฺฏ ุฌุฏุฏ ุงุฌุงุฏ ฺฉููุฏ**.

#### **ุชุนุฑู Refactoring:**

**Refactoring** (ุจุงุฒุณุงุฒ) ุจู ูุนูุง **ุจูุจูุฏ ุณุงุฎุชุงุฑ ุจุฏูู ุชุบุฑ ุฑูุชุงุฑ** ุงุณุช.

```
ุชุนุฑู ุฑุณู: "ุชุบุฑ ุฏุฑ ุณุงุฎุชุงุฑ ุฏุงุฎู ูุฑูโุงูุฒุงุฑ ฺฉู ุขู ุฑุง ุฑุงุญุชโุชุฑ ุจุฑุง ููู 
ู ุงุฑุฒุงูโุชุฑ ุจุฑุง ุชุบุฑ ูโฺฉูุฏุ ุจุฏูู ุชุบุฑ ุฑูุชุงุฑ ููุฌูุฏ"
```

**ูฺฉุชู ฺฉูุฏ:** ุชูุงูุช ุจู refactoring ู ุชูุฒฺฉุงุฑ ุนููู:
- **Refactoring**: ูุฌููุนูโุง ุงุฒ ุชุบุฑุงุช **ุฑุฒ ู ูุญุฏูุฏ** (ูุซู extract method)ุ **ุจุง ุชุณุชโูุง ุญูุงุช**
- **Cleanup ุนููู**: ููฺฉู ุงุณุช ุดุงูู ฺฉุงุฑูุง **ุฑุณฺฉโุขูุฒ** ูุงููุฏ ุจุงุฒููุณ ุจุฎุดโูุง ุจุฒุฑฺฏ ุจุงุดุฏ

> **ุงุตู ุทูุง Refactoring:**  
> ููฺฏุงู refactoringุ **ูุจุงุฏ ุชุบุฑุงุช ุนููฺฉุฑุฏ** ุฑุฎ ุฏูุฏ (ุงฺฏุฑฺู ุนููฺฉุฑุฏ ูโุชูุงูุฏ ุจูุชุฑ ุง ุจุฏุชุฑ ุดูุฏ)

### **ด. ุจูููโุณุงุฒ (Optimization)**

Optimization ุดุจู refactoring ุงุณุชุ ุงูุง **ูุฏู ูุชูุงูุช** ุฏุงุฑุฏ:

- **Refactoring**: ุณุงุฎุชุงุฑ ุฑุง ุชุบุฑ ูโุฏูู ุชุง **ูุงุจูโูููโุชุฑ** ุดูุฏ
- **Optimization**: ููุงุจุน (ุฒูุงูุ ุญุงูุธู) ุฑุง ุชุบุฑ ูโุฏูู

ุฏุฑ **ูุฑ ุฏู ุญุงูุช**ุ **ุนููฺฉุฑุฏ (functionality) ุฑุง ุซุงุจุช ูฺฏู ูโุฏุงุฑู**.

### **ต. ฺฏุฑุฏููโุขูุฑ (Putting It All Together)**

ููุชุฑุฒ ุงูุฌุง ฺฉ ุฌุฏูู ููู ุงุฑุงุฆู ูโุฏูุฏ ฺฉู **ุณู ฺุฒ ูุชูุงูุช ุฑุง ุฏุฑ ูุฑ ููุน ุชุบุฑ** ูุดุงู ูโุฏูุฏ:

| ููุน ุชุบุฑ | ุณุงุฎุชุงุฑ | ุนููฺฉุฑุฏ ุฌุฏุฏ | ุนููฺฉุฑุฏ ููุฌูุฏ | ุงุณุชูุงุฏู ุงุฒ ููุงุจุน |
|---------|--------|-------------|--------------|-----------------|
| **ุงุถุงูู ฺฉุฑุฏู ูุงุจูุช** | ุชุบุฑ | ุชุบุฑ | - | - |
| **ุฑูุน ุจุงฺฏ** | ุชุบุฑ | - | ุชุบุฑ | - |
| **Refactoring** | ุชุบุฑ | - | - | - |
| **Optimization** | - | - | - | ุชุบุฑ |

**ุฏู ูฺฉุชู ููู:**
1. ุฏุฑ **Refactoring ู Optimization** ูุฑ ุฏูุ **ุนููฺฉุฑุฏ ููุฌูุฏ ุซุงุจุช ูโูุงูุฏ**
2. **ุงุถุงูู ฺฉุฑุฏู ูุงุจูุช ู Refactoring ู Optimization** ููฺฏ **ุนููฺฉุฑุฏ ููุฌูุฏ ุฑุง ุญูุธ** ูโฺฉููุฏ (ุง ุชุบุฑุงุช ุจุณุงุฑ ฺฉู)

### **ถ. ุจุฎุด ูพุงุงู: ุฑุณฺฉ (Risky Change)**

ููุชุฑุฒ ุณุคุงู ุจุณุงุฑ ููู ูโูพุฑุณุฏ:

> **"ุงฺฏุฑ ูุฑ ุชุบุฑ ุฑุณฺฉโุขูุฒ ุงุณุชุ ฺูุฏุฑ ุชุบุฑ ูโุชูุงูู ุชุญูู ฺฉููุ"**

ุงู ฺฉ **ุชุตูุฑ ุดูุงุชฺฉ** ุชุฑุณู ูโฺฉูุฏ ฺฉู ูุดุงู ูโุฏูุฏ **ูุง ููุดู ููุฏุงุฑ ุฒุงุฏ ุฑูุชุงุฑ ููุฌูุฏ ุฑุง ุจุงุฏ ุญูุธ ฺฉูู**:

- ุฑูุชุงุฑ ููุฌูุฏ = 95%
- ุฑูุชุงุฑ ุฌุฏุฏ = 5%

**ุงู ุนู:**
- ุจุงุฏ ุชุบุฑุงุช **ฺฉูฺฺฉ** ุฑุง **ุฏุฑุณุช** ุงูุฌุงู ุฏูู
- ุจุงุฏ **ุจุดุชุฑ ุฑูุชุงุฑ** ุฑุง ุญูุธ ฺฉูู ู **ููโุฏุงูู** ฺู ููุฏุงุฑ ุงุฒ ุขู ุฏุฑ ุฎุทุฑ ุงุณุช

#### **ุณู ุณุคุงู ุจุฑุง ฺฉุงูุด ุฑุณฺฉ:**
1. **ฺู ุชุบุฑุงุช ุจุงุฏ ุงูุฌุงู ุฏููุ**
2. **ฺฺฏููู ูโุฏุงูู ฺฉู ุฏุฑุณุช ุงูุฌุงู ุดุฏู ุงุณุชุ**
3. **ฺฺฏููู ูโุฏุงูู ฺฉู ฺุฒ ุฑุง ุดฺฉุณุชู ูุณุชูุ**

#### **ุงุณุชุฑุงุชฺ ูุงุฏุฑุณุช:**

ุจุณุงุฑ ุงุฒ ุชูโูุง ุชูุงุด ูโฺฉููุฏ ุจุง **ุงุฌุชูุงุจ ุงุฒ ุชุบุฑุงุช** ุฑุณฺฉ ุฑุง ฺฉู ฺฉููุฏ:
- ุณุงุณุช: "ุงฺฏุฑ ุฎุฑุงุจ ูุณุชุ ุฏุณุช ูุฒูุฏ"
- ุฏุฑุฎูุงุณุช ฺฉู: ฺฉุฏ ุฑุง ุฏุฑูู ฺฉ ูุชุฏ ูุฑุงุฑ ุฏูุฏ ุชุง ุงุฒ ูุงุฒ ุจู ุชุบุฑุงุช ุจุดุชุฑ ุฌููฺฏุฑ ุดูุฏ

**ูุดฺฉู ุงู ุงุณุชุฑุงุชฺ:** ฺฉุฏ ุจุฒุฑฺฏโุชุฑ ูโุดูุฏุ ุฏุฑฺฉ ุขู ุณุฎุชโุชุฑ ูโุดูุฏุ ู **ฺฉูฺฺฉโุชุฑ ฺฉุฑุฏู ฺฉูุงุณโูุง ุณุฎุชโุชุฑ ูโุดูุฏ**

---

---

## **ูุตู ฒ: Working with Feedback (ฺฉุงุฑ ุจุง ุจุงุฒุฎูุฑุฏ)**

### **ููุฏูู: ุฏู ุฑุงู ุจุฑุง ุชุบุฑ ฺฉุฏ**

ููุชุฑุฒ ุฏู ุฑูุด ุจูุงุฏู ุจุฑุง ุชุบุฑ ฺฉุฏ ุฑุง ูุนุฑู ูโฺฉูุฏ:

#### **ุฑูุด ุงูู: Edit and Pray (ูุฑุงุด ู ุฏุนุง ฺฉุฑุฏู)**

ุงู ุฑูุด **ุงุณุชุงูุฏุงุฑุฏ ุตูุนุช** ุงุณุช:

```
ฑ. ุจุฑูุงููโุฑุฒ ุฏูู ุชุบุฑุงุช
ฒ. ุงุทููุงู ุงุฒ ููู ฺฉุฏ
ณ. ุงูุฌุงู ุชุบุฑุงุช
ด. ุงุฌุฑุง ุณุณุชู ุจุฑุง ุงูฺฉู ุจุจูุฏ ุชุบุฑ ูุนุงู ุดุฏ
ต. "ูพูฺฉุฑ ุฎูุฑ" (poking around) ุจุฑุง ุงุทููุงู ุงุฒ ุนุฏู ุดฺฉุณุชู ฺุฒ
```

**ุจู ูุธุฑ ุญุฑููโุง ุงุณุชุ**

ุธุงูุฑุงู ุจูู! ุงูุง ฺฉ ูุดฺฉู ุนูู ุฏุงุฑุฏ:

> **"ุณูุงูุช (safety) ููุท ฺฉ ุชุงุจุน ุงุฒ ุฏูุช ูุณุช. ูฺ ฺฉุณ ุฌุฑุงุญโ ุฑุง ุงูุชุฎุงุจ ููโฺฉูุฏ ฺฉู ุจุง ฺุงูู ฺฉุงุฑ ฺฉูุฏุ ุตุฑูโูุธุฑ ุงุฒ ุงูฺฉู ฺูุฏุฑ ูุฑุงูุจ ุงุณุช!"**

ููุชุฑุฒ ุงูุฌุง ฺฉ ุชุดุจู ุฏูู ูโฺฉูุฏ: ูุซู ุฌุฑุงุญุ ุชุบุฑ ููุซุฑ ูุฑูโุงูุฒุงุฑ ูุงุฒ ุจู **ููุงุฑุชโูุง ุนููโุชุฑ** ุฏุงุฑุฏ.

#### **ุฑูุด ุฏูู: Cover and Modify (ูพูุดุด ู ุชุบุฑ)**

ุงู ุฑูุด **ูุชูุงูุช** ุงุณุช:

> **"ุงุฏู ุงุตู: ููฺฉู ุงุณุช ููฺฏุงู ุชุบุฑ ูุฑูโุงูุฒุงุฑ ุจุง ฺฉ ุดุจฺฉู ุงูู ฺฉุงุฑ ฺฉูู."**

**ุดุจฺฉู ุงูู ฺุณุชุ** **ุชุณุชโูุง!**

ููุช ุชุณุชโูุง ุฎูุจ ุฏุฑ ุงุทุฑุงู ฺฉุฏ ุฏุงุดุชู ุจุงุดู:
- ุชุบุฑุงุช ุฑุง ุงูุฌุงู ูโุฏูู
- **ููุฑ** ูโูููู ุงุซุฑุงุช ุฎูุจ ุงุณุช ุง ุจุฏ
- ฺฉูุชุฑู ุจุดุชุฑ ุจุฑ ฺฉุงุฑูุงู ุฏุงุฑู

### **ููุงุณู ุฏู ุฑูุด: ฺฉ ุณูุงุฑู ูุงูุน**

#### **ุณูุงุฑู Edit and Pray:**

```
ุตุจุญ: ุชุบุฑ ฺฉ ุชุงุจุน ูพฺุฏู ูพุณ ุงุฒ ุชุญูู ุฏูู
ุดุงู: ฺฏุฒุงุฑุด ุชุณุชโูุง ุดุจ
โ ุชุณุชโูุง AE1021 ู AE1029 ุดฺฉุณุชูโุงูุฏ!
ูุงูุดุฎุต: ุขุง ุฎุทุง ูุง ุงุณุชุ ุง ุชู ุฏฺฏุฑุ
โ ุณุงุนุชโูุง debugging ุจุฑุง ูพุฏุง ฺฉุฑุฏู ูุดฺฉู
```

#### **ุณูุงุฑู Cover and Modify:**

```
ฑ. ูุชุฏ ุฑุง ุงุจุชุฏุง ฒฐ unit test ูโููุณู
ฒ. ุชุณุชโูุง ุชูุงู pass ูโฺฉููุฏ โ ุฑูุชุงุฑ ูุนู ูุดุฎุต ุงุณุช
ณ. ูโุฎูุงูู ฺฉุฏ ุฑุง ุจูุชุฑ ุจูููู โ refactor ูโฺฉูู
ด. ุจุนุฏ ุงุฒ ูุฑ ุชุบุฑ ุฑุฒ โ ุชุณุชโูุง ุงุฌุฑุง ูโุดููุฏ (ุณุฑุน!)
ต. ุงฺฏุฑ logic ุบูุท ุจูุฏ โ ุชุณุช ฑ ุฏููู ุจุนุฏ ูุงูููู ุดุฏ
ถ. ุจุงุฒฺฏุดุช ุนูุจ ู ุฏูุจุงุฑู ุณุน
ท. ูุชุฌู: ฺฉุฏ ูุงุถุญโุชุฑ + ุชุณุชโูุง ูุญุงูุธ + ุงุทููุงู
```

### **ุชูุงูุช ุจุงุฒุฎูุฑุฏ (Feedback):**

| ูุนุงุฑ | Edit and Pray | Cover and Modify |
|------|----------------|------------------|
| **ุฒูุงู ุจุงุฒุฎูุฑุฏ** | ุดุจ ุจุนุฏ (ุฑฺฏุฑุณูู ุชุณุช) | ฑ ุฏููู (unit test) |
| **ุฏูุช localization** | ุณุงุนุชโูุง ุจุฑุง ูพุฏุง ฺฉุฑุฏู ูุดฺฉู | ุฏูููโูุง |
| **ุชุนุฏุงุฏ ุชุบุฑุงุช ุฏุฑ ูู** | ต-ถ ุชุบุฑ = ูุงูุดุฎุต ูุดฺฉูโูุง | ฑ ุชุบุฑ = ูุดฺฉู ูุงุถุญ |
| **ฺฉุงุฑ ฺฉู ุงูุฌุงู ุดุฏ** | ุ โ | โ โ โ |

### **ุชุนุฑู Unit Testing (ุชุณุช ูุงุญุฏ)**

#### **Unit Test ฺุณุชุ**

ุชุณุช **ุงุฒูููโุดุฏู** (isolated) ุจุฑุง **ูุงุญุฏูุง ุงุชู** ุฑูุชุงุฑ:
- ุฏุฑ **ฺฉุฏ imperative**: ุชุงุจุนโูุง
- ุฏุฑ **ฺฉุฏ OOP**: ฺฉูุงุณโูุง

#### **ูุซุงู:**

```java
public class EmployeeTest extends TestCase {
    private Employee employee;
    
    protected void setUp() {
        // ุงู ฺฉุฏ ูุจู ุงุฒ ูุฑ ุชุณุช ุงุฌุฑุง ูโุดูุฏ
        employee = new Employee("Fred", 0, 10);
    }
    
    public void testNormalPay() {
        assertEquals(400, employee.getPay());
    }
    
    public void testOvertime() {
        TDate newCardDate = new TDate(11, 10, 2000);
        employee.addTimeCard(new TimeCard(newCardDate, 50));
        assertTrue(employee.hasOvertimeFor(newCardDate));
    }
}
```

#### **ฺุฑุง ุงุฒููุงุณูู ููู ุงุณุชุ**

**ณ ูุดฺฉู ุจุง ุชุณุชโูุง ุจุฒุฑฺฏ:**

1. **Error Localization (ุชุดุฎุต ุฎุทุง)**
   - ุชุณุช ุจุฒุฑฺฏ 100 ฺฉูุงุณ ุฑุง ุชูุฑู ูโฺฉูุฏ
   - ุงฺฏุฑ ุดฺฉุณุช ุจุฎูุฑุฏ: ุฎุทุง ฺฉุฌุงุณุชุ ๐ค
   - ุชุณุช ฺฉูฺฺฉ ฑ ฺฉูุงุณ ุฑุง ุชูุฑู ูโฺฉูุฏ
   - ุงฺฏุฑ ุดฺฉุณุช ุจุฎูุฑุฏ: ุฎุทุง ูุฒุฏฺฉ ุงุณุช! โ

2. **Execution Time (ุณุฑุนุช ุงุฌุฑุง)**
   - ุชุณุช ุจุฒุฑุบ: ฐ.ฑ ุซุงูู ร ณฐฐฐฐ ุชุณุช = **ฑ ุณุงุนุช** โ
   - ุชุณุช ฺฉูฺฺฉ: ฐ.ฐฐฑ ุซุงูู ร ณฐฐฐฐ ุชุณุช = **ณฐ ุซุงูู** โ

3. **Coverage (ูพูุดุด)**
   - ุชุณุช ุจุฒุฑฺฏ: ฺฉุฏุงู ุจุฎุด ุชูุฑู ุดุฏุ ูุงูุดุฎุต
   - ุชุณุช ฺฉูฺฺฉ: ุฏููุงู ฺฉุฏุงู ุจุฎุด

### **ุฎุตูุตุงุช ุชุณุช ูุงุญุฏ ุฎูุจ:**

```
ฑ. โ ุณุฑุน ุงุฌุฑุง ูโุดูุฏ
ฒ. โ ูุณุงุฆู ุฑุง ุชุฒโุชุฑ localize ูโฺฉูุฏ
```

> **ุงุตู ุทูุง:**  
> **"ฺฉ unit test ฺฉู ฐ.ฑ ุซุงูู ุทูู ฺฉุดุฏุ ฺฉ unit test ฺฉูุฏ ุงุณุช!"**

#### **ุชุณุช ฺฉู unit test ูุณุช:**

ฺฉ ุชุณุช unit test **ูุณุช** ุงฺฏุฑ:
- โ ุจุง ุฏุชุงุจุณ ุตุญุจุช ฺฉูุฏ
- โ ุงุฒ ุดุจฺฉู ุงุณุชูุงุฏู ฺฉูุฏ
- โ ูุงูโุณุณุชู ุฑุง ููุณ ฺฉูุฏ
- โ ูุงุฒ ุจู ุชูุธูุงุช ูุญุท ุฎุงุต ุฏุงุดุชู ุจุงุดุฏ

**ูฺฉุชู:** ุงููุง ุชุณุชโูุง ุฎูุจ ูุณุชูุฏุ ุงูุง "integration test" ุง "functional test" ูุณุชูุฏุ ูู unit test.

### **ูุดฺฉู Legacy Code Dilemma:**

> **"ููุช ฺฉุฏ ุฑุง ุชุบุฑ ูโุฏููุ ุจุงุฏ ุชุณุช ุฏุฑ ุฌุง ุฏุงุดุชู ุจุงุดู.**  
> **ุจุฑุง ฺฏุฐุงุดุชู ุชุณุช ุฏุฑ ุฌุงุ ุงุบูุจ ุจุงุฏ ฺฉุฏ ุฑุง ุชุบุฑ ุฏูู!"**

ุงู ฺฉ ุญููู ุฏุฑุงูุช ฺฉููุฏู ุงุณุช:

```
ุจุฑุง ุชุณุช ููุดุชู
    โ
ุจุงุฏ ฺฉุฏ ุฑุง ุชุบุฑ ุฏูู (break dependencies)
    โ
ุจุฏูู ุชุณุช ุงู ฺฉุงุฑ ุฑุณฺฉโุฏุงุฑ ุงุณุช!
    โ
ุงูุง ุชุณุช ููุดุชู ูุงุฒ ุจู ุชุบุฑ ฺฉุฏ ุฏุงุฑุฏ...
```

**ุญู:** ุชุบุฑุงุช **ุจุณุงุฑ ูุญุงูุธูโฺฉุงุฑุงูู** ู **ูุฑุญููโุง** ุฏุฑ ุงุจุชุฏุง

### **The Legacy Code Change Algorithm (ุงูฺฏูุฑุชู ุชุบุฑ ฺฉุฏ Legacy)**

ููุชุฑุฒ ฺฉ ุงูฺฏูุฑุชู **ต ูุฑุญููโุง** ุงุฑุงุฆู ูโุฏูุฏ:

```
ฑ. ุดูุงุณุง ููุงุท ุชุบุฑ (Identify change points)
   "ฺฉุฌุง ุจุงุฏ ุชุบุฑ ฺฉููุ"

ฒ. ุงูุชู ููุงุท ุชุณุช (Find test points)
   "ฺฉุฌุง ุจุงุฏ ุชุณุช ุจููุณู ุชุง ุงู ุชุบุฑ ุฑุง detect ฺฉููุ"

ณ. ุดฺฉุณุชู Dependencyโูุง (Break dependencies)
   "ฺฺฏููู ฺฉุฏ ุฑุง ุงุฒ ูุงุจุณุชฺฏโูุง ุณูฺฏู ุฌุฏุง ฺฉููุ"

ด. ููุดุชู ุชุณุชโูุง (Write tests)
   "ููุดุชู ุชุณุชโูุง ูุญุงูุธ ุฏุฑ ุงุทุฑุงู ุชุบุฑุงุช"

ต. ุชุบุฑ ู Refactoring (Make changes and refactor)
   "ุชุบุฑ ฺฉุฏ ู ุจูุชุฑ ฺฉุฑุฏู ุณุงุฎุชุงุฑ ุจุง ุชุณุชโูุง ุญูุงุช"
```

#### **ูุฏู ููุง:**

> **ูุฑ ุฑูุฒ ูู ููุท ฺฉุฏ ุฌุฏุฏุ ุจูฺฉู ุชุณุชโูุง ุขู ุฑุง ูู ุจุณุงุฒุฏ.**  
> **ุจุชุฏุฑุฌ "ุฌุฒุงุฑ" ุงุฒ ฺฉุฏ ุชุณุชโุดุฏู ุธุงูุฑ ูโุดูุฏ.**  
> **ุฏุฑ ููุงุช ุณุฑุฒููโูุง ุจุฒุฑฺฏ ุชุณุชโุดุฏู:**

```
      ๐๏ธ ๐๏ธ
    ๐๏ธ ๐๏ธ ๐๏ธ       (continent of tested code)
  ๐๏ธ ๐๏ธ ๐๏ธ ๐๏ธ
๐๏ธ ๐๏ธ ๐๏ธ ๐๏ธ ๐๏ธ
```

### **ุฎูุงุตู ุงู ูุตู:**

**ุฏู ุฑุงู ฺฉุงุฑ:**
- **Edit and Pray** = ุจุฏูู ุดุจฺฉู ุงููุ ุฎุทุฑูุงฺฉ
- **Cover and Modify** = ุจุง ุชุณุชโูุงุ ฺฉูุชุฑูโุดุฏู

**ูุงุญุฏ ุงุณุงุณ ฺฉุงุฑ: Unit Test**
- ุณุฑุน
- ุงุฒูููโุดุฏู
- ูุณุงุฆู ุฑุง ุชุฒ localize ูโฺฉูุฏ

**ฺุงูุด Legacy:** ูุงุฒ ุจู ุชุบุฑ ฺฉุฏ ุจุฑุง ุชุณุชุ ุจุฏูู ุชุณุช!  
**ุญู:** ุงูฺฏูุฑุชู ต ูุฑุญููโุงุ ฺฏุงู ุจู ฺฏุงู

---

ุจุณุงุฑ ุฎูุจ. ุงฺฉููู ุจุฎุด "Sensing and Separation" ุฑุง ุจุง ูุงุฑุณ ุฏุฑุณุช ู ุฑูุงู ุฏูุจุงุฑู ุจุฑุงุชุงู ูโููุณู:

## **ูุตู ณ: Sensing and Separation (ุญุณ ู ุฌุฏุงุณุงุฒ)**

### **ููุฏูู: ุจู ุขุฑูุงู ู ูุงูุนุช**

ููุชุฑุฒ ุฏุฑุณ ุฑุง ุจุง ฺฉ ุชุตูุฑ ุงุฏูโุขู ุดุฑูุน ูโฺฉูุฏ:

> **"ุฏุฑ ุฏูุง ุจโููุตุ ูุจุงุฏ ฺุฒ ุฑุง ุจุฑุง ฺฉุงุฑ ุจุง ฺฉ ฺฉูุงุณ ุชุบุฑ ุฏูู. ููุท ูโุฎูุงูู ฺฉูุงุณ ุฑุง ุฏุฑ test harness ุงุฌุงุฏ ฺฉููุ ุชุณุช ุจููุณูุ ู ุจู ฺฉุงุฑ ุจุนุฏ ุจุฑูู."**

ุงูุง **ูุงูุนุช ูุชูุงูุช ุงุณุช.**

ูุงุจุณุชฺฏโูุง (Dependencies) ูุดฺฉูโุขูุฑู ูุณุชูุฏ: ุจุฑุง ุณุงุฎุช ฺฉ ุดุกุ ุจู ุดุก ุฏฺฏุฑ ูุงุฒ ุฏุงุฑูุ ู ุขู ุดุก ุฏูุจุงุฑู ุจู ุดุก ุณูู ูุงุฒ ุฏุงุฑุฏ... ู ุงู ุฒูุฌุฑู ุงุฏุงูู ูโุงุจุฏ. **ูุชุฌู:** ุชูุฑุจุงู ฺฉู ุณุณุชู ุจุงุฏ ุฏุฑ test harness ุจุงุฑฺฏุฐุงุฑ ุดูุฏ!

ุฏุฑ ุจุนุถ ุฒุจุงูโูุง ุงู ูุดฺฉู ฺฉูฺฺฉ ุงุณุช. ุงูุง ุฏุฑ **C++** ูุซูุงูุ ููุท ุจุฎุด linking ูโุชูุงูุฏ ุจุณุงุฑ ููุชโฺฏุฑ ุจุงุดุฏ.

### **ุฏู ุฏูู ุจุฑุง ุดฺฉุณุชู Dependencyโูุง**

ููุชุฑุฒ ุฏู ุฏูู ุฌุฏุงฺฏุงูู ู ูู ุฑุง ูุนุฑู ูโฺฉูุฏ:

#### **ฑ. Sensing (ุญุณ ฺฉุฑุฏู)**

ูุดฺฉู: "**ููโุชูุงูู ูุชุงุฌ ุฑุง ฺฉู ุงู ฺฉูุงุณ ุชููุฏ ูโฺฉูุฏ ุจุจูู!**"

ูุซุงู: ฺฉูุงุณ ฺฉู ูุณุชูู ุจู ุดุจฺฉู (network) ุง ุณุฎุชโุงูุฒุงุฑ ุตุญุจุช ูโฺฉูุฏ.

**ุฑุงูโุญู:** ฺฉ fake object ูุฑุงุฑ ุฏูุฏ ู ูุชุงุฌ ุฑุง ุงุฒ ุขู ุจุฎูุงูุฏ.

#### **ฒ. Separation (ุฌุฏุงุณุงุฒ)**

ูุดฺฉู: "**ูู ููโุชูุงูู ุงู ฺฉูุงุณ ุฑุง ุงุตูุงู instantiate ฺฉูู!**"

ูุซุงู: ุจุฑุง ุณุงุฎุช ฺฉูุงุณุ ูุงุฒ ุจู ุฏุชุงุจุณ ุง ููุงุจุน ุฎุงุฑุฌ ูุงูุน ุงุณุช.

**ุฑุงูโุญู:** dependency ุฑุง ุจุดฺฉูุฏ ุชุง ุจุชูุงูุฏ ฺฉูุงุณ ุฑุง ุจุฏูู ุขู ููุงุจุน ุจุณุงุฒุฏ.

### **ูุซุงู ูุงูุน: NetworkBridge**

```java
public class NetworkBridge {
    public NetworkBridge(EndPoint[] endpoints) { ... }
    public void formRouting(String sourceID, String destID) { ... }
}
```

**ฺุงูุดโูุง:**
- โ EndPointโูุง ุงุฒ ุทุฑู socket ุจู ุดุจฺฉู ูุงูุน ูุชุตู ูโุดููุฏ
- โ ุชุณุช ููฺฉู ุงุณุช freeze ุดูุฏ ุง timeout ฺฉูุฏ  
- โ ููโุชูุงูุฏ ุจุจูุฏ **ฺฉ ุฏุงุฏูโุง** ุจู ุดุจฺฉู ุงุฑุณุงู ูโุดูุฏ
- โ ูุงุฒ ุจู **ูุฑ ุฏู**: sensing ู separation

### **ุญู: Fake Objects (ุงุดุงุก ุชููุจ)**

#### **ูุซุงู ุณุงุฏู: ูุฑูุดฺฏุงู ู ุตูุฏูู**

**ุจุฏูู Fake (ูุดฺฉูโุฏุงุฑ):**

```java
public class Sale {
    public void scan(String barcode) {
        // ... ฺฉุฏ ูพฺุฏู
        realCashRegister.displayLine("Milk $3.99");  // ูุงุฒ ุจู ุณุฎุชโุงูุฒุงุฑ ูุงูุน!
    }
}
```

**ุจุง Fake (ุญูโุดุฏู):**

```java
// ูุฑุญู ุงูู: ฺฉ interface ุจุฑุง Display
public interface Display {
    void showLine(String line);
}

// ูุฑุญู ุฏูู: ฺฉูุงุณ ูุงูุน ุจุฑุง ุชููุฏ
public class ArtR56Display implements Display {
    public void showLine(String line) {
        // ฺฉุฏ ุฏุฑุงูุฑ ุณุฎุชโุงูุฒุงุฑ ุญูู
    }
}

// ูุฑุญู ุณูู: Fake ุจุฑุง ุชุณุชโูุง
public class FakeDisplay implements Display {
    private String lastLine = "";
    
    public void showLine(String line) {
        lastLine = line;  // ููุท ุฐุฎุฑู ฺฉู
    }
    
    public String getLastLine() {
        return lastLine;  // ุชุณุช ูโุชูุงูุฏ ููุฏุงุฑ ุฑุง ุจุฎูุงูุฏ
    }
}

// ูุฑุญู ฺูุงุฑู: Sale ุงุตูุงุญโุดุฏู
public class Sale {
    private Display display;
    
    public Sale(Display display) {
        this.display = display;
    }
    
    public void scan(String barcode) {
        // ... logic
        String itemLine = item.name() + " " + item.price();
        display.showLine(itemLine);  // ููุท ุงุฒ interface ุงุณุชูุงุฏู ฺฉู
    }
}

// ูุฑุญู ูพูุฌู: ุชุณุช!
public class SaleTest extends TestCase {
    public void testDisplayAnItem() {
        FakeDisplay display = new FakeDisplay();
        Sale sale = new Sale(display);
        sale.scan("1");
        
        assertEquals("Milk $3.99", display.getLastLine());
    }
}
```

### **ุฏู ุทุฑู ฺฉ Fake Object**

FakeDisplay ฺฉ "ุฏูฺฏุงููโุชู" ุฏุงุฑุฏ:

```java
FakeDisplay display = new FakeDisplay();
Sale sale = new Sale(display);  // Sale ููุท Display ุฑุง ูโุจูุฏ

// ุงูุง ุชุณุช ูโุชูุงูุฏ ุจุดุชุฑ ุจุจูุฏ:
display.getLastLine();  // ุงู ูุชุฏ ููุท ุจุฑุง ุชุณุช ุงุณุช
```

| ูฺฏุงู | ฺฉ | ูุชุฏโูุง |
|------|-------|--------|
| **ฺฉูุงุณ Sale** | ุชููุฏ | ููุท `showLine()` |
| **ุชุณุช** | testing | `showLine()` + `getLastLine()` |

### **ุณุคุงู ุงูุชูุงุฏ: ุขุง ุงู "ุชุณุช ูุงูุน" ุงุณุชุ**

**ุงุนุชุฑุงุถ:** "ุงู ุชุณุช ุณุฎุชโุงูุฒุงุฑ ูุงูุน ุฑุง ุชุณุช ููโฺฉูุฏ!"

**ุฌูุงุจ:** "ฺฉุงููุงู ุฏุฑุณุช ุงุณุช. ุงูุง ฺฏุงูฺฏ ฺฉุงุฑ ูโฺฉูู:
- **ุงู ุชุณุช:** "ุขุง Sale ุจู Display ฺู ููุดุช ูโูุฑุณุชุฏุ"
- **ุชุณุช ุฏฺฏุฑ:** "ุขุง ArtR56Display ุขู ุฑุง ุฏุฑุณุช ููุงุด ูโุฏูุฏุ"

ุงฺฏุฑ ูุฑ ุฏู pass ฺฉููุฏ โ ุณุณุชู ฺฉุงูู ฺฉุงุฑ ูโฺฉูุฏ!"

### **Mock Objects (ุจูุชุฑ ุงุฒ Fake)**

Fake ุฑุง ุดูุง ูโููุณุฏ. **Mock** ุฎูุฏฺฉุงุฑ ุงุณุช:

```java
public void testDisplayAnItem() {
    MockDisplay display = new MockDisplay();
    
    // ุจฺฏู ฺฉู ุงูุชุธุงุฑ ุฏุงุฑ ุงู ูุชุฏ ุจุง ุงู ุฏุงุฏู ูุฑุงุฎูุงู ุดูุฏ
    display.setExpectation("showLine", "Milk $3.99");
    
    Sale sale = new Sale(display);
    sale.scan("1");
    
    display.verify();  // ุจุฑุฑุณ ฺฉู!
}
```

**Mock ูโฺฏูุฏ:**
- "ูู ุงูุชุธุงุฑ ุฏุงุฑู `showLine` ุจุง "Milk $3.99" ูุฑุงุฎูุงู ุดูุฏ"
- ุจุนุฏ ุงุฒ ุงุฌุฑุง: โ (ุงฺฏุฑ ุฏุฑุณุช ุจูุฏ) ุง โ (ุงฺฏุฑ ุงุดุชุจุงู ุจูุฏ)

### **ุฎูุงุตู: Sensing ุจุฑ Separation**

| ูุนุงุฑ | Sensing | Separation |
|------|---------|-----------|
| **ูุดฺฉู** | ููโุชูุงูู **ูุชุงุฌ ุฑุง ุจุจูู** | ููโุชูุงูู ฺฉูุงุณ ุฑุง **instantiate ฺฉูู** |
| **ุฑุงูโุญู** | Fake Object | Break Dependency |
| **ูุซุงู** | FakeDisplay | Parameterize Constructor |
| **ุณุคุงู** | "ฺู ูุชุฌูโุง ุตุงุฏุฑ ุดุฏุ" | "ฺฺฏููู ุดุฑูุน ฺฉููุ" |

---

ุจุณุงุฑ ุฎูุจ. ุงฺฉููู ุจุฎุด "The Seam Model" ุฑุง ุจุฑุงุชุงู ูโููุณู:

## **ูุตู ด: The Seam Model (ูุฏู ุฏุฑุฒูุง)**

### **ููุฏูู: ูฺฏุงู ุฌุฏุฏ ุจู ฺฉุฏ**

ููุชุฑุฒ ฺฉ ูฺฉุชู ููู ุฑุง ูุทุฑุญ ูโฺฉูุฏ:

> **"ููุช ุณุน ูโฺฉู ฺฉุฏูุง ููุฌูุฏ ุฑุง ุชุญุช ุชุณุช ุฏุฑุขูุฑุ ูุชูุฌู ูโุดู ฺฉู ฺฉุฏ ุจุฑุง ุชุณุชโููุณ ุณุงุฎุชูโูุดุฏู ุงุณุช. ุงู ููุท ูุฑุจูุท ุจู ฺฉ ุฒุจุงู ุฎุงุต ูุณุชุ ุงู ฺฉ ูุดฺฉู ุนููู ุงุณุช."**

ุงู ฺฉ ุฑุงู ูฺฉุฑ ุฌุฏุฏ ูพุดููุงุฏ ูโุฏูุฏ: **ูุฏู Seam** (ุฏุฑุฒ).

### **ุชุนุฑู Seam (ุฏุฑุฒ)**

```
ุฏุฑุฒ: ููุทูโุง ุฏุฑ ุจุฑูุงูู ุงุณุช ฺฉู ูโุชูุงู ุฑูุชุงุฑ ุขู ุฑุง ุจุฏูู ูุฑุงุด ุฏุฑ ุขู ููุทู ุชุบุฑ ุฏู.
```

#### **ูุซุงู ุณุงุฏู:**

ุชุตูุฑ ฺฉูุฏ ุงู ฺฉุฏ C++:

```cpp
bool CAsyncSslRec::Init() {
    if (m_bSslInitialized) {
        return true;
    }
    // ... ฺฉุฏ ุฏฺฏุฑ ...
    
    if (!m_bFailureSent) {
        m_bFailureSent = TRUE;
        PostReceiveError(SOCKETCALLBACK, SSL_FAILURE);  // โ ุงู ุฎุท ูุดฺฉูโุฏุงุฑ ุงุณุช
    }
    
    // ... ฺฉุฏ ุฏฺฏุฑ ...
    return true;
}
```

**ูุดฺฉู:** `PostReceiveError` ุชุงุจุน global ุงุณุช ฺฉู ุจุง ุณุณุชู ุฏฺฏุฑ ุงุฑุชุจุงุท ุจุฑูุฑุงุฑ ูโฺฉูุฏ. ุฏุฑ ุชุณุชุ ุงู ูุดฺฉูโุขูุฑู ุงุณุช.

**ุณุคุงู:** ฺฺฏููู ูโุชูุงูู ุงู ุฎุท ุฑุง **ุจุฏูู ุงูฺฉู ฺฉุฏ ุฑุง ูุฑุงุด ฺฉูู** ุฎุงููุด ฺฉููุ

**ุฌูุงุจ:** **Seamโูุง!**

### **ุณู ููุน Seam (ุฏุฑุฒ)**

#### **ฑ. Object Seam (ุฏุฑุฒ ุดุกโฺฏุฑุง)**

**ุจูุชุฑู ฺฏุฒูู ุจุฑุง ุฒุจุงูโูุง OOP:**

```cpp
// ูุฑุญู ุงูู: ูุชุฏ virtual ุฏุฑ ฺฉูุงุณ
class CAsyncSslRec {
    // ...
    virtual void PostReceiveError(UINT type, UINT errorcode);
};

// ูุฑุญู ุฏูู: ูพุงุฏูโุณุงุฒ ุฏุฑ ูุงู cpp
void CAsyncSslRec::PostReceiveError(UINT type, UINT errorcode) {
    ::PostReceiveError(type, errorcode);  // delegate ุจู ุชุงุจุน global
}

// ูุฑุญู ุณูู: ุฏุฑููฺฏุงู ุชุณุชุ ุงุฒ subclass ุงุณุชูุงุฏู ฺฉู
class TestingAsyncSslRec : public CAsyncSslRec {
    virtual void PostReceiveError(UINT type, UINT errorcode) {
        // ุฎุงู ุจฺฏุฐุงุฑ ุง log ฺฉู
    }
};

// ุฏุฑููฺฏุงู ุชุณุช:
TestingAsyncSslRec* obj = new TestingAsyncSslRec();
obj->Init();  // ุงฺฉููู PostReceiveError ูุฑุงุฎูุงู ููโุดูุฏ!
```

**ููุท ูุนุงูโุณุงุฒ (Enabling Point):** ุฌุง ฺฉู ุดุก ุฑุง ูโุณุงุฒ (constructor call)

#### **ฒ. Preprocessing Seam (ุฏุฑุฒ ูพุดโูพุฑุฏุงุฒูุฏู)**

**ุจุฑุง C/C++:**

```cpp
// ูุงู ุงุตู:
#include <DFHLItem.h>
#include "localdefs.h"  // โ ุฏุฑุฒ ุงูุฌุง ุงุณุช

void account_update(int account_no, struct DFHLRecord *record, int activated) {
    if (activated) {
        db_update(account_no, record->item);
    }
}

// ูุงู localdefs.h (ููุท ุจุฑุง ุชุณุช):
#ifdef TESTING
    struct DFHLItem *last_item = NULL;
    int last_account_no = -1;
    
    #define db_update(account_no, item) \
        { last_item = (item); last_account_no = (account_no); }
#endif
```

**ููุท ูุนุงูโุณุงุฒ:** ุซุงุจุช preprocessor `TESTING`

#### **ณ. Link Seam (ุฏุฑุฒ linking)**

**ุจุฑุง ุณุณุชูโูุง compile ู link:**

```cpp
// ูุงู ุงุตู (production)
void drawLine(int x1, int y1, int x2, int y2) {
    // ... ฺฉุฏ ุณุฎุชโุงูุฒุงุฑ ูุงูุน ...
}

// ูุงู ุชุณุช (test library)
// Makefile:
# production build:
gcc main.o graphics.o -o app
# test build:
gcc main.o test_graphics.o -o test_app
```

**ููุท ูุนุงูโุณุงุฒ:** ุชูุธู Makefile ุง build script

### **Enabling Point (ููุท ูุนุงูโุณุงุฒ)**

```
ูุฑ Seam ฺฉ "ููุท ูุนุงูโุณุงุฒ" ุฏุงุฑุฏ:
ุฌุง ฺฉู ุชุตูู ูโฺฏุฑ ฺฉุฏุงู ุฑูุชุงุฑ ุฑุง ุงุณุชูุงุฏู ฺฉู (ุชููุฏ ุง ุชุณุช).
```

| Seam Type | Seam Location | Enabling Point |
|-----------|--------------|----------------|
| **Object** | ูุชุฏ virtual | ุฌุง ฺฉู ุดุก ูโุณุงุฒ |
| **Preprocessing** | ุฎุท include | define preprocessor |
| **Link** | ุชุงุจุน global | Makefile/build script |

### **ฺุฑุง Seam ููู ุงุณุชุ**

ููุชุฑุฒ ุชูุถุญ ูโุฏูุฏ:

> **"ุจุฒุฑฺฏโุชุฑู ฺุงูุด ุจุฑุง ุชุณุชโููุณ ุฏุฑ ฺฉุฏ legacy ุดฺฉุณุชู dependencyโูุง ุงุณุช. ูุฏู Seam ุจู ูุง ฺฉูฺฉ ูโฺฉูุฏ **ูุฑุตุชโูุง ุฑุง ฺฉู ุฏุฑ ฺฉุฏ ููุฌูุฏ ุงุณุช** ุจุจูู."**

### **ูุชุฌู ฺฏุฑ: ฺฉุฏุงู Seam ุฑุง ุงูุชุฎุงุจ ฺฉููุ**

**ุชุฑุฌุญ:**

1. โ **Object Seams** (ุจูุชุฑู) - ุฑูุดูุ ุชุบุฑ design
2. โ๏ธ **Link Seams** - ููุฏุ ุงูุง ูุงุฒ ุจู ุชุบุฑ build
3. โ๏ธ **Preprocessing Seams** - ูุฏุฑุชููุฏุ ุงูุง ูพฺุฏู

---

